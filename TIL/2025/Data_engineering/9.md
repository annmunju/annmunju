# **9.**  분석, 머신러닝 및 역 ETL을 위한 데이터 서빙

- 이 단계는 단순히 데이터를 저장하거나 전달하는 것이 아니라, **실제 사용자가 데이터를 통해 가치를 얻을 수 있도록 제공하는 과정을 뜻한다.**

---

### 9.1 데이터 서빙의 일반적인 고려 사항

- 데이터를 단순히 저장·전송하는 게 아니라 **신뢰성, 사용 목적, 제품화, 서비스 방식** 등을 고려해야 한다.
- **핵심은 "사용자가 데이터를 어떻게 활용할 수 있을지"에 초점을 맞추는 것.**

---

### 9.1.1 신뢰

- 데이터 제공의 **가장 중요한 원칙은 신뢰**.
- 신뢰 없는 데이터는 아무리 화려한 BI, ML 모델에도 쓸모가 없다.
- 신뢰를 위해서는:
    - **데이터 품질 관리**: 정합성 검증, 중복·에러 확인
    - **데이터 검증**(Validation), **관찰 가능성**(Observability) 확보
    - SLA(Service Level Agreement), SLO(Service Level Objective) 등을 통해 서비스 품질 보장
- **즉, 데이터는 언제나 믿을 수 있어야 한다. 그렇지 않으면 아무도 쓰지 않는다.**

---

### 9.1.2 사용 사례와 사용자

- 데이터를 쓸 사람(사용자)과 그 목적(사용 사례)을 명확히 정의해야 한다.
- 단순히 리포트 보는 게 아니라, 행동(Action)을 만들어내야 진짜 가치가 있다.
    - 예: 리드 스코어링으로 마케팅 실행, CRM 추천 모델 적용 등.
- **엔지니어는 항상 "누가, 어떤 상황에서, 어떻게 데이터를 쓸까?"라는 질문을 던져야 한다.**

---

### 9.1.3 데이터 제품

- 데이터를 그냥 흘려보내는 게 아니라, **제품(Product)처럼 설계**해야 한다.
- 좋은 데이터 제품의 조건:
    - **사용자의 목적을 달성하게 돕는 것** (단순 보고서가 아님)
    - 반복적으로 쓰이면서 개선되는 것 (Feedback loop)
    - 사용자 관점에서 쉽게 접근할 수 있는 것
- 즉, **데이터도 소프트웨어 제품처럼 사용자 중심으로 설계·개선해야 한다**는 개념.

---

### 9.1.4 셀프 서비스 여부

- 사용자가 직접 데이터를 탐색하고 활용할 수 있도록 **셀프 서비스 환경**을 제공할지 여부를 고려해야 한다.
- **장점**
    - 데이터팀에 모든 요청이 몰리지 않아 병목 완화 → 사용자 자율성 강화.
    - 경영진/현업 사용자가 즉시 분석 가능, 의사결정 속도 향상.
    - SQL 지식이 부족해도 데이터 접근·활용 가능.
- **단점**
    - 실제 환경에서 셀프 서비스 구축은 난도가 높고, 운영 관리 부담이 큼.
    - 데이터 품질/거버넌스 미비 시 잘못된 해석이나 오남용 위험 존재.
    - 과도하게 제공될 경우 오히려 복잡성 증가, ROI 저하 가능.
- **성공 조건**
    - 적절한 사용자 그룹 선정 (모든 사용자에게 열어주지 말 것).
    - 실제 "업무/의사결정"에 필요한 기능 중심 제공.
    - 자율성(사용자 권한)과 가드레일(제한/검증)의 균형 유지.

---

### 9.1.5 데이터 정의 및 논리

- 데이터가 쓸모 있으려면 **정확성과 신뢰성**이 담보되어야 한다.
- **데이터 정의(Data Definition)**: 데이터의 의미를 조직 전체에서 동일하게 이해하도록 문서화.
- **데이터 로직(Data Logic)**: 데이터 계산·가공 과정에서 공식을 명확히 하고 일관성 있게 적용.
- 정의와 논리를 명문화하면 데이터 품질, 신뢰성, 재ㅌ사용성이 보장된다.
- **즉, 데이터를 어디서, 어떻게 계산했는지 모두가 같은 방식으로 이해하게 해야 한다.**

---

### 9.1.6 데이터 메시(Data Mesh)

- 데이터 서빙의 조직적 접근 방식.
- 각 팀이 자기 데이터에 대해 **책임**을 가지고, 다른 팀이 쓸 수 있도록 데이터를 준비·공유하는 체계.
- 중앙 집중식이 아니라, **분산된 P2P 구조(Peer-to-Peer ="동등한 주체들 간 직접 연결" / 각 팀이 소유자 이면서 소비자의 역할을 하는 구조)** 로 운영.
    - 장점: 데이터 소유권과 책임이 명확해짐.
    - 단점: 팀 간 협업, 셀프서비스 체계가 안 갖춰지면 혼란 발생.
- **즉, 데이터도 “조직 전체가 함께 쓰는 자원”이므로, 각 팀이 자기 데이터를 제품처럼 제공해야 한다는 개념.**

---

### 9.2 분석

- 데이터 서빙의 첫 번째 주요 활용 영역은 **분석(Analytics)**.
- 목적: 데이터에서 **인사이트·패턴**을 찾고, 의사결정을 지원.

---

### 9.2.1 비즈니스 분석

- **장기적이고 전략적인 의사결정**을 지원하는 분석
- 과거와 현재 데이터를 기반으로 인사이트를 도충
    - EX)
        - **대시보드**: 핵심 지표(KPI, 매출, 고객 유지율 등)를 시각화. (BI 툴 예: 루커, 시세Sense, 파워BI 등)
        - **리포트**: 특정 질문에 답하기 위한 분석 결과를 정리한 문서.
        - **애드혹 분석**: 즉석에서 특정 원인 파악을 위해 실행하는 SQL/노트북 기반 분석.
- 데이터 엔지니어의 역할: 분석가가 쉽게 데이터에 접근하고, 신뢰할 수 있는 데이터 소스를 제공.

---

### 9.2.2 운영 분석

- 목표: **실시간 인사이트**를 기반으로 즉각적인 행동 실행.
- 예시: 애플리케이션 모니터링, 장애 탐지, 로그 분석, 알림 시스템.
- 비즈니스 분석과 차이:
    - 비즈니스 분석 = 장기적 관점(전략/경영)
    - 운영 분석 = 단기적 관점(즉시 실행/장애 대응)
- 스트리밍 데이터의 활용이 점점 중요해지고 있음.

---

### 9.2.3 임베디드 분석

- **임베디드 분석(Embedded Analytics)**: 데이터를 별도 대시보드가 아닌 **애플리케이션 내부**에 직접 녹여 사용자에게 제공.
- 예시:
    - 스마트 온도 조절기 → 실시간 에너지 사용량을 앱에서 바로 보여줌.
    - 전자상거래 플랫폼 → 판매·재고·반품 데이터를 실시간으로 고객에게 제공.
- 장점: 사용자는 데이터를 보면서 즉시 의사결정 가능.
- 고려사항: **짧은 데이터 지연(latency), 빠른 쿼리 성능, 높은 동시성(concurrency)** 필요.

---

### 9.3 머신러닝

- 데이터 서빙의 두 번째 주요 영역.
- ML은 점점 보편화 → 데이터 엔지니어가 **ML 엔지니어와 협업**하는 경우 증가.
- 역할:
    - 데이터 과학자/ML 엔지니어가 모델을 만들고,
    - 데이터 엔지니어가 **데이터 파이프라인, 특징 엔지니어링, 인프라 관리** 지원.
- 예시: 온도·습도 데이터로 반바지 품질 예측
    - **문제**: 반바지를 만들 때 원단 보관 창고의 **온도·습도**가 품질(불량률)에 큰 영향을 줌.
    - **데이터**: 온도, 습도, 원단 상태 같은 센서 데이터 수집.
    - **해결**:
        1. 데이터 엔지니어 → 데이터를 안정적으로 수집/정리하는 파이프라인 구축.
        2. ML 엔지니어 → 이 데이터를 학습해  **품질 예측 모델** 개발.
    - **효과**: 앞으로 원단 환경을 보고 불량 가능성을 예측 → 불량 줄이고 품질 개선.

---

### 9.4 데이터 엔지니어가 ML에 관해 알아야 할 사항

- 데이터 엔지니어가 알아야 할 ML 관련 핵심 개념:
    - 지도학습/비지도학습/준지도학습의 차이
    - 분류 vs 회귀
    - 시계열 분석, 예측
    - 전통적 알고리즘 (로지스틱 회귀, 트리 기반 학습, SVM 등)
    - AutoML과 모델 서빙 방식
    - 데이터 랭글링(Data Wrangling), 정형/비정형 데이터 처리
        - 데이터 임베딩, 배치 vs 스트리밍 처리
    - 데이터 품질과 ML 모델의 성능 관계 (데이터 캐스케이드, 데이터 편향 등)
- **즉, 데이터 엔지니어는 모델을 직접 만드는 게 아니라, ML이 잘 돌아가도록 데이터와 인프라를 책임진다.**

---

### 9.5 분석 및 ML을 위한 데이터 서빙 방법

### 9.5.1 파일 교환

- 가장 기본적인 데이터 서빙 방식.
- **데이터 파일(CSV, 엑셀 등)을 생성해 공유.**
    - 장점: 단순하고 빠름.
    - 단점: 버전 관리 어려움, 확장성 부족.
- 유용성: **비정형 데이터** 전달, 협업 시 간단한 교환.

### 9.5.2 데이터베이스

- 분석 및 ML 서빙에 있어 핵심.
- **SQL 기반 쿼리로 데이터 제공 → 결과를 CSV 등으로 전달하거나 앱에서 직접 활용.**
- 데이터 웨어하우스/데이터 레이크 형태로 확장 가능.
- 특징:
    - **OLAP(분석용)** 시스템 → 빠른 조회/대규모 집계에 최적화.
    - **Pushdown 방식**: 계산을 DB 서버에서 처리 후 결과만 제공.
- 장점: 확장성, 동시성, 성능 관리.
- 데이터 엔지니어 역할: DB 관리, 최적화, 쿼리 성능 개선, ML/BI 팀에 필요한 데이터 공급.

---

### 9.5.3 스트리밍 시스템

- **실시간 데이터로 분석과 ML을 지원하는 체계**
- 실시간 분석이 점점 중요해짐 → 스트리밍 데이터 기반 분석 필요.
- 기존 쿼리와 달리 **방출된 지표(emitted metric)** 개념 이해 필요.
- OLAP + 스트리밍 처리 시스템이 결합하는 추세.

---

### 9.5.4 쿼리 페더레이션

- **데이터를 한데 모으지 않고, 있는 그대로 연결해 조회하는 것**
- 여러 데이터 소스(RDBMS, 데이터 레이크, 웨어하우스 등)를 한 번에 조회하는 방식.
    - 장점: 원천 데이터를 통합하지 않고도 다양한 소스를 조회 가능.
    - 단점: 성능 문제, 지연 발생 가능
- 대규모 분석보다는 특정 시점 조회같은 곳에서 많이 쓰임

---

### 9.5.5 데이터 공유

- 조직 내/조직 간 안전한 데이터 교환을 위한 체계.
- 클라우드 기반 멀티테넌트 스토리지를 통해 실현.
- 주요 플랫폼: Snowflake, Databricks, Redshift 등.
- 장점: 협업·대외 제공에 용이, 데이터 중복 줄임.
- 주의: **데이터 보안 및 접근 제어**

---

### 9.5.6 시맨틱과 메트릭 계층

- **시맨틱 계층(Semantic Layer)**: 데이터에 의미와 비즈니스 로직을 덧입힘.
- **메트릭 계층(Metric Layer)**: KPI 등 핵심 지표를 일관되게 정의하고 계산.
- 예시 도구: LookML(Looker), dbt.
- 장점: 지표 정의 일관성 유지, 중복 계산 문제 해결.
- **즉, 데이터 지표의 표준화·공용화**

---

### 9.5.7 노트북에서의 데이터 서빙

- 데이터 과학자의 주요 작업 환경.
- 노트북(Jupyter, Colab 등)에서 데이터 웨어하우스/데이터 레이크와 직접 연결.
- 장점: 실험, 탐색, 분석에 용이.
- 고려사항:
    - 자격 증명 관리 (보안 중요)
    - 메모리 한계 → 클라우드/분산 처리 고려 (예: Dask, Ray, SageMaker, Vertex AI 등)
    - 운영 환경으로 확장할 경우 추가 관리 필요
- **즉, 노트북은 실험실, 하지만 운영에 쓰려면 보안·확장성까지 챙겨야 함**

---

### 9.6 역 ETL (Reverse ETL)

- **정의**: 분석용 데이터(OLAP DB → CRM 같은 운영 시스템)로 되돌려 제공하는 것.
- **등장 배경**: 2010년대 후반~2020년대 초반 CRM/업무 시스템 통합 수요 증가.
- **활용 예시: 분석된 데이터가 어떤 가치를 창출하는가?**
    - **고객 데이터 CRM에 되돌림 → 영업팀 활용 → 매출 증가**
        - 영업팀은 CRM에서 고객 정보를 보고 있는데,
        - 그 CRM에 “이 고객은 VIP 가능성 있음” 같은 태그가 추가되면?
        - 영업팀은 그 고객을 집중 공략해서 매출을 올릴 수 있음.
    - **예측 모델 결과를 CRM에 넣음 → 현업이 직접 확인**
        - 예: “이 고객은 이탈 확률 80%”라는 모델 결과가 CRM 화면에 뜸.
        - 상담원이 고객과 통화할 때 그걸 보고 맞춤 대응 가능.
- **주의점**:
    - 단순히 “데이터 다시 넣기”를 넘어 **피드백 루프** 형성.
    - 잘못된 예측치가 들어가면 광고비 낭비 등 비용 커짐 → 모니터링 체계 필요.

---

### 9.7 함께 작업하는 사람

- 데이터 엔지니어는 단독으로 일하지 않고 다양한 역할을 지원
- **데이터 과학자, MLOps/ML 엔지니어, 비즈니스 관계자(관리자, 경영진)**
- 데이터 엔지니어는 데이터를 **최종 사용하는 데 대한 책임은 지지 않지만**, 가능한 한 **최고 품질의 데이터 제품을 제공할 책임**이 있다.
- 팀 단위 협력 구조 속에서 업무 분담을 명확히 하고, 협업을 통한 성과가 중요.

---

### 9.8 드러나지 않는 요소 (서빙 단계에서 중요)

- 데이터 엔지니어링 수명 주기의 마지막은 **서빙 단계**. 여기서 데이터가 실제로 사용자의 손에 닿음.
- **핵심 역할**: 보안, 데이터 관리, 데이터옵스, 아키텍처, 오케스트레이션.

### 9.8.1 보안

- 데이터 공유와 시스템 접근에는 **최소 권한 원칙** 필요.
- IAM 역할, 접근 제어, 워크플로우 기반 공유 등으로 권한을 세밀히 조정.
- 사용되지 않는 데이터는 폐기 → 보안 리스크 줄임.

### 9.8.2 데이터 관리

- 데이터 품질과 신뢰성 유지가 서빙 단계의 핵심.
- 데이터팀은 사용자 요청에 따라 문제 수정 및 개선 프로세스를 마련해야 함.
- 규제 준수, 데이터 중복/누락 방지, 데이터 보존/폐기 정책 중요.

### 9.8.3 데이터옵스

- **데이터 품질·보안·거버넌스** 모니터링 체계.
- 모니터링 대상: 데이터 상태, 품질, 보안, 서빙되는 모델 버전, SLO 달성 시간.
- 데이터옵스는 운영 자동화, 대시보드, 알림 시스템 등을 활용.

### 9.8.4 데이터 아키텍처

- 피드백 루프를 빠르고 효율적으로 → 데이터 접근 최적화.
- 데이터 과학팀과 분석팀이 쉽게 실험하고 협업할 수 있는 환경 제공.
- 마이크로서비스, 워크플로우 자동화로 분석가 지원 강화.

### 9.8.5 오케스트레이션

- 데이터 흐름을 일정 시간에 맞춰 안정적으로 전달하는 것.
- **중앙집중형 vs 분산형 접근**: 조직 상황에 따라 선택.
- DAG 관리, 게이트키핑, 자동화된 조율 시스템 필요.
- DBA, 분석 엔지니어, 데이터 엔지니어, ML 엔지니어 등 다양한 역할이 참여.

---

### 9.8.6 소프트웨어 엔지니어링

- 최근에는 데이터 제공이 **훨씬 간단해짐** → 오픈소스 프레임워크 확산 덕분.
- 그러나 데이터 엔지니어는 여전히 **코드 실행·변환·최적화** 책임을 져야 함.
- **활용 영역**
    - 쿼리/스토리지 최적화 (예: LookML, ORM, 메트릭 레이어)
    - SQL 코드 리뷰 및 최적화 제안
    - CI/CD 파이프라인 설계 및 운영
    - 데이터/ML팀의 **인프라·도구 사용 교육 및 지원**
- 임베디드 분석의 경우, 애플리케이션 개발자와 협력하여 효율적 쿼리 제공.
- 개발자가 요구하는 데이터 접근·처리를 보장하는 것도 데이터 엔지니어 역할.

---

### 9.9 결론

- 데이터 엔지니어링 수명 주기는 **서빙 단계**에서 끝남.
- 하지만 여기서 끝이 아니라 피드백 루프(구축 → 학습 → 개선)가 시작됨.
- **핵심 메시지**:
    - 피드백을 통해 지속적으로 시스템과 **자신을 개선하는 자세 필요**.
    - 이해관계자와 협력하며 공격적 대응 대신 개선 기회로 활용.
    - 훌륭한 데이터 엔지니어는 **새로운 피드백에 열려 있고, 기술 개선을 습관화함**