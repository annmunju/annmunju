<!-- 125p~ -->

## 3.2 디자인 패턴 6: 멀티라벨

멀티라벨이란 주어진 학습 데이터에 둘 이상의 라벨을 할당할 수 있는 문제 (정답지 두개 이상)

### 문제 
- 일반적으로 사용하는 출력계층의 활성화 함수는 소프트맥스
    - 합치면 1이 되는 확률값의 출력 목록 (분류수만큼 출력됨) 에서 max 값을 선택

### 솔루션
- 주어진 학습 예제에 둘 이상 라벨을 할당할 수 있는 모델 구축을 위해 최종 출력 계층에 시그모이드 활성화 함수 사용.
    - 시그모이드 배열의 각 개별값은 0과 1 사이의 범위를 가지는 부동 소수점값
    - 즉 각각의 결과에 대해 개별 결과값이 나타나므로 확률이 높은 N개의 라벨을 채택하면 됨.

### 트레이드오프와 대안
- 두 클래스에 걸친 모델의 시그모이드 출력
    - 멀티클래스 분류 : 여러 클래스 중 하나의 정답 라벨 예측 `keras. layers.Dense(1, activation='softmax')`
    - 이진 분류 : 두 클래스 중 하나의 정답 라벨 예측 `keras. layers.Dense(1, activation='sigmoid')`
    - 멀티라벨 예측 : 여러 클래스 중 여러 정답 라벨 예측 `keras. layers.Dense(2, activation='sigmoid')`
- 손실함수는 어떤걸 사용할까?
    - binary_crossentropy : 이진 분류에서 사용하는 손실함수. 
    - 시그모이드 출력이 있는 멀티라벨 모델에서도 동일한 손실을 쓸수 있음. 본질적으로 작은 이진분류 문제를 여러번하는게 멀티라벨 분류
- 시그모이드 결과 파싱하기
    - 출력 계층에서 각 클래스의 확률을 평가하고 상황에 대한 확률 임계값을 정의해 이보다 높은 것을 채택하는 방식
    - 임계값은 어떤 것을 예측하냐에 따라 다르게 나타남
    - 정확한 태그를 얻기보다 관련된 태그르 여러개 제시하는 것이 우선인 경우에 사용
- 데이터셋 고려 사항
    - 데이터셋에 계층적 라벨이 있을 수 있음 (예. ImageNet의 라벨 계층 구조)
    - 계층적 라벨 처리 방식 
        - 단순 접근 방식을 사용해 계층 구조와 무관하게 모든 라벨 배치하여 리프 노드 라벨 예제가 충분하도록 한다
        - 캐스케이드 디자인 패턴 : 더 높은 수준의 라벨 식별을 위해 하나의 모델을 구축. -> 분류 후 별도 모델로 보냄 (세분화된 라벨 적용)
- 라벨이 겹치는 입력
    - 동일한 이미지에 서로 다른 다수 레벨이 지정된 경우. -> 멀티라벨 분류 모델 (모두 예측하는 모델) 바람직

- OVR (one versus rest)
    - 여러 이진 분류기 학습
    - 모든 라벨에 대해 T/F 학습하는 방식. 그리고 신뢰도에 대한 Threshold 정의 하고 이 임계치를 넘기면 채택하는 방식
    - 해당 방식은 SVM과 같이 이진 분류만 수행할 수 있는 모델 아키텍처와 함께 쓸 수 있음

