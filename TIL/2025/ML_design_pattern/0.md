# 머신러닝 전체 워크플로

1. **데이터 수집**
2. **데이터 검증**
3. **데이터 전처리**
4. **가설 설정**
5. **모델 구축**
6. **학습 및 평가**
7. **모델 배포**

---

## 데이터 전처리

### 데이터 전처리란?
- **정의**: 원시 데이터를 분석 및 모델 학습에 더 적합하고 의미 있는 형식으로 변환하는 과정  
- **목적**: 모델 학습에 더 적합한 데이터 생성

### 데이터의 단계별 명칭

| 단계                 | 설명 |
|----------------------|------|
| Raw Data (원시 데이터)        | 초기에 수집된 원본 그대로의 데이터 |
| Prepared Data (가공된 데이터) | Raw Data에서 정제 및 목적에 맞는 일부만 추출한 데이터 |
| Engineering Features (가공된 피처) | 스케일링, 인코딩 등 피처 엔지니어링 기법 적용된 데이터 |

- **해결할 내용**: 데이터 누락값, 노이즈, 불일치, 이상치 등  
- **결과**: 전처리 성공 시 모델 품질/효율/신뢰도 향상, 실패 시 편향, 오류, 잘못된 예측

---

## 초기 데이터 탐색 및 이해

- **데이터 구조·차원 확인** (행/열 개수)
- **데이터 타입 확인**: 수치형/범주형/날짜형 등 → 변수별 적절한 처리 계획 필요
- **데이터 샘플 확인**: 직접 눈으로 데이터 패턴과 예상 적합성 확인  
- **기초 기술 통계 분석**: 주요 통계 지표(개수, 평균, 표준편차, 최소/최대, 사분위수)로 전반 분포 파악  
  - **평균 vs 중앙값**: 왜도(skewness) 확인
  - **표준편차**: 첨도(kurtosis)
  - **최소/최대값** 등

---

## 데이터 정제 패턴

### 결측치(Missing Value) 처리

1. **탐지**: 정량적 파악 (분포 시각화 등)
2. **제거**: 결측치가 패턴 없이 무작위면 해당 행 삭제(데이터 손실 적을 때)
3. **대체**  
   - 단순 대체: 수치형은 평균/중앙값, 범주형은 최빈값  
     (쉽지만 분산 감소&상관성 왜곡 가능)
   - 모델기반 대체: KNN 등 변수 관계 기반 예측 대체 (계산비용 높음)

---

### 이상치 처리

1. **탐지**  
   - 통계적 기법:  
     - z-score (평균±표준편차 벗어남)  
     - IQR (Q1-1.5IQR 미만, Q3+1.5IQR 초과)
   - 시각화: Box Plot  
   - 머신러닝: DBSCAN 등 클러스터 밖 노이즈 감지

2. **처리**
   - **제거**: 해당 데이터 삭제
   - **대체**: 상한/하한값으로 대체
   - **변환**: 로그/제곱근 변환(분포 완화)
   - **유지**: 분석·모델에 포함 또는 별도 관리

---

## 피처 엔지니어링

### 수치형 데이터 변환 (스케일링)

| 기법      | 공식                                         | 변환 후 범위          | 이상치 민감도 | 주요 사용 사례                |
|-----------|----------------------------------------------|----------------------|--------------|------------------------------|
| 정규화    | $x' = \frac{x - \min(x)}{\max(x) - \min(x)}$ | 0~1                  | 높음         | 이미지 처리(픽셀값), 신경망 입력 |
| 표준화    | $x' = \frac{x - \mu}{\sigma}$                | 평균 0, 표준편차 1   | 보통         | 선형회귀, 로지스틱회귀, SVM 등   |

- **목적**: 변수 단위 통일, 특정 변수 과도 영향 방지

---

### 범주형 데이터 변환 (인코딩)

- **목적**: 문자열 범주형을 모델이 이해 가능한 숫자형으로 변환
- **데이터 종류**:  
    - 명목형(순서 없음)  
    - 순서형(순서 있음)

#### 주요 인코딩 기법

| 기법               | 설명                               | 장점                        | 단점                    | 추천 데이터 유형  | 추천 모델 계열         |
|--------------------|------------------------------------|----------------------------|-------------------------|-------------------|------------------|
| Label Encoding     | 범주를 $0,1,2...$로 매핑           | 차원 증가 없음              | 순서 왜곡, 선형모델 취약 | 순서형, 트리 명목형 | 트리 계열           |
| One-Hot Encoding   | 각 범주를 별 컬럼(0/1)로 표현      | 순서 왜곡 없음, 성능 우수   | 차원 폭증(차원의 저주)   | 명목형             | 선형, 신경망        |
| Ordinal Encoding   | 순서따라 정수로 매핑               | 순서 정보 보존              | 주관 개입, 사전지식 필요 | 순서형             | 모든 모델           |
| Binary Encoding    | 범주 → 이진코드, 각 자리 컬럼화     | 차원 효율적                 | 해석 어려움              | 고차원 명목형       | 모든 모델           |
| Hashing            | 해시함수로 고정 차원 매핑          | 대용량 처리, 차원 제어 용이 | 해시충돌 가능            | 초고차원 명목형    | 모든 모델           |
| Embedding          | 저차원 밀집 벡터로 변환            | 의미관계 학습, 차원 축소    | 학습/구현 복잡           | 초고차원 명목형    | 신경망              |

---

## 탐색적 데이터 분석(EDA) 및 가설 설정

### EDA란?
- **정의**: 정해진 가설 없이 관찰/시각화로 데이터 구조·패턴·이상·관계 파악
- **목적**: 데이터로 부터 질문(가설) 얻기
- **방법**: 다양한 시각화를 통한 패턴 분석

#### 분석 종류
- **단변량 분석**: 변수 분포, 특성
- **이변량 분석**: 2변수 관계 파악  
    - 수치형-수치형: 산점도  
    - 범주형-수치형: 막대그래프  
    - 시간-수치형: 선그래프
- **다변량 분석**: 3개 이상 변수 상호작용  
    - 상관관계 히트맵  
    - 페어플롯(산점도+히스토그램)

> **팁:** 시각화들을 연결해 데이터가 전하는 일관된 서사 그려보기

---

## 가설 설정 방법론

### 데이터 분석 접근법
- **EDA (탐색적 데이터 분석)**: 데이터를 통해 귀납적으로 가설 생성
- **CDA (확인적 데이터 분석)**: 가설의 통계적 유의성 검증 (연역적)

**프로세스:**  
EDA → 관계 발견 및 가설정의 → CDA로 통계검정(가설 채택/기각)

### 좋은 가설의 조건
- **구체성**: 측정 가능(예. 월 N회 이하 대여 고객이 이탈률이 높다)
- **검증 가능성**: 데이터·분석법으로 참/거짓 판단 가능
- **실행 가능성**: 검증 후 구체적 비즈니스 액션 가능

### 가설 설정 프로세스
1. **분석질문 정의**: 비즈니스 문제 정의
2. **EDA 통한 패턴발견**: 시각화, 통계로 변수 관계/패턴/특이점 식별
3. **구체적 가설 수립**: 검증가능한 명제 공식화
4. **가설 우선순위화**: 기대효과·실행편의성 기준으로 분석순서 결정
