<!-- 92p~ -->

## 2.5 디자인 패턴 4: 멀티모달 입력

### 문제
- 모달리티가 다른 경우 동일한 모델의 입력으로 사용할 수 없음
- 그래서 임베딩과 같은 패턴을 사용해서 모델이 이해할 수 있는 방식으로 변환해 다른 테이블 특징들과 결합

### 솔루션
- 임베딩 패턴 사용 (케라스 임베딩으로 텍스트 변환)

### 트레이드오프와 대안
- 멀티모달 디자인 패턴은 동일 모델에서 다른 입력 형식을 표현하는 방법 찾기
- 반대로 동일 데이터를 다른 방식으로 표현할 수도 있음
    - 테이블 데이터를 다양한 방식으로 표현하기
    - 예) 평점 데이터를 좋음 / 나쁨으로 카테고리화해 추가하기

- 텍스트의 멀티모달 표현
    - BOW 방식 : 모델에 입력된 텍스트를 글자가 아닌 단어들을 담고 있는 주머니처럼 간주. BOW는 텍스트의 순서를 유지하지는 않지만 모델에 보내는 각 텍스트 조각에서 특정 단어의 존재 여부를 감지. 멀티-핫 인코딩처럼 이미 존재하는 단어 세트가 얼마나 포함되는지 숫자로 변환하는 것.
    - 임베딩 방식은 훈련이 필요하지만, bow 방식은 빠르게 사용 가능.
    - 임베딩 방식은 순서나 의미가 함께 적용되지만, bow 방식은 사용 단어 유무만 판별.
- 텍스트에서 테이블 특징 추출하기
    - 텍스트에서 메타데이터 뽑아내기 (문장 길이, 단어 수, ?! 여부 등)

- 이미지의 멀티모달 표현
    - 이미지는 픽셀값 배열 (0~1 사이의 1차원 흑백 혹은 0~255 사이의 3차원-RGB 컬러)
- 이미지를 타일 구조로 표현하기 : CNN
    - 지정된 커널 크기로 필터를 씌운 것 처럼 해당 구간에 max값을 뽑아 한칸 한칸씩 이동하면서 차원을 축소시킴 (3x3 -> 2x2)
- 서로 다른 이미지 표현의 결합
    - 픽셀값 + 타일 구조 쓰라는건데 (책에서는)
    - 일단 픽셀값이랑 타일구조를 같이 쓰려면 이미지 자체가 너무 크면 픽셀값이 너무 많아짐
    - 그렇다고 저픽셀인걸 같이 쓰면 도움이 될지는 알수없음 (솔직히 노이즈 될 수 있음)
- 이미지와 메타데이터를 함께 사용하기
    - 이미지 처리 합성곱 계측과 테이블 데이터 완전 연결 계층을 분리해서 이후에 합치는 방식.

- 멀티모달 특징 표현과 모델의 해석 가능성
    - 딥러닝 모델은 설명 불가
    - 단일 모델에서 여러 데이터 표현을 결합하면 특징이 종속되어 더욱 설명이 어려워짐
    - 별도로 만들고 합치면 안되나? : 그니까 모델 해석이 중요하면 별도로 하고 합치고, 성능이 중요하면 합쳐서 훈련하기