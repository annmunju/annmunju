1. 데이터 처리 시스템 설계
    
Dataflow에서 DoFn 메서드 파이프라인 코드가 느려지면 → 클라우드 프로파일러 사용

데이터 레이크 중앙집중식 데이터 검색 솔루션 : Dataplex (메타데이터 관리)

각 지역별 프로젝트 권장 정책 관리는 폴더 구조로 정책 할당
    
2. 데이터 수집 및 처리
    
https://jaemunbro.medium.com/gcp-dataflow-apache-beam-%EC%95%8C%EC%95%84%EB%B3%B4%EA%B8%B0-a4f5f09b98d1

Dataflow 스트리밍 데이터 파이프라인 윈도잉 옵션 : Tumbling windows 

BigQuery에서 대량의 입력 데이터를 Cloud SQL에서 제공되는 소량의 자주 변경되는 데이터와 결합하는 경우 → Cloud SQL에서 BigQuery로 주기적 동기화 후 BigQuery에서 조인
    

| 항목 | **Dataflow** | **Dataproc** | **Composer** |
| --- | --- | --- | --- |
| ☁️ 서비스 유형 | **스트리밍/배치 데이터 처리 엔진 (Fully Managed)** | **Spark/Hadoop 클러스터 기반 데이터 처리 (Managed YARN)** | **워크플로우 오케스트레이션 (Apache Airflow 기반)** |
| 🔧 기술 기반 | Apache Beam | Apache Spark, Hadoop, Hive 등 | Apache Airflow |
| 📦 주 사용 용도 | 실시간 로그/이벤트 처리, 대용량 ETL | 머신러닝, 대규모 분석, 커스텀 분산 처리 | ETL 순서 조정, 파이프라인 스케줄링 및 모니터링 |
| ⚙️ 실행 방식 | 코드 기반 파이프라인 실행 (Python/Java Beam SDK) | 클러스터 생성 후 코드 제출 (PySpark 등) | DAG 정의(Python) 후 task별로 실행 지시 |
| ⏱️ 처리 방식 | **스트리밍 + 배치** 모두 지원 | 배치 중심, Spark 스트리밍 가능 | 주기적/이벤트 기반 워크플로우 |
| 🔄 관리 방식 | **Fully Managed**, 자동 스케일링, 오류 복구 | **Managed Cluster**, 수동 튜닝 필요 | Airflow Fully Managed, UI 기반 모니터링 |
| 💰 비용 | 사용한 리소스 기반 요금 (초 단위) | 클러스터 시간 기반 (Idle 비용 발생 가능) | Composer 인스턴스 + task 리소스 요금 |
| 🧠 배우기 난이도 | 중간 (Beam 이해 필요) | 중상 (Spark, Yarn, HDFS 등 필요) | 중간 (Airflow DAG 이해 필요) |

1. 데이터 저장
    
cloud storage : standard > nearline > coldline > archive

| 클래스 | 용도 | 접근 빈도 | 최소 저장 기간 | 특징 |
| --- | --- | --- | --- | --- |
| **Standard** | 자주 사용하는 데이터 (예: 실시간 분석, 웹콘텐츠) | 매우 자주 | 없음 | 빠르고 낮은 지연시간 |
| **Nearline** | 가끔 사용하는 데이터 (예: 월 1회 백업) | 월 1회 정도 | 30일 | 읽기보다 저장 비용이 비쌈 |
| **Coldline** | 거의 사용 안 하는 장기 보관 데이터 | 분기 1회 이하 | 90일 | 저장 비용 낮고, 읽기 비용 높음 |
| **Archive** | 규제나 장기 보관 목적 데이터 (예: 1년 이상 보관) | 거의 없음 | 365일 | 저장 비용 가장 낮음, 읽기 비용 가장 비쌈 |

스패너 : 자동 관리형, 글로벌 트랜잭션 + 수평 확장 + SQL 지원 + 무중단 운영 가능한 RDBMS
    
2. 분석 데이터 준비 및 사용
    
PostgreSQL 데이터. 분석을 위해 이 데이터를 BigQuery로 전송. 소스 데이터는 계층적이며 자주 함께 쿼리됨. 성능이 뛰어난 BigQuery 스키마를 설계하는 경우 → 중첩되도록 만들기 

PostgreSQL 정규화 → BigQuery 비정규화 + 중첩 + 반복 필드 구조
= JOIN 줄이고, 읽기 위주의 분석을 빠르게
    
3. 데이터 워크로드 유지관리 및 자동화
    
근무 시간 동안 BigQuery에서 대화형 쿼리를 실행하는 데이터 분석가 팀이 있습니다. 또한 수천 개의 보고서 생성 쿼리가 동시에 실행됩니다. "비율 제한 초과: 이 프로젝트 및 지역에 대한 동시 쿼리가 너무 많습니다."라는 오류가 자주 발생합니다. → 보고서를 한번에 뽑도록 (배치처리)

Cymbal Retail의 동료가 프로젝트의 Dataproc 자동 확장 구성에 대해 질문합니다. Google에서 권장하는 자동 확장 활성화 상황은 무엇인가요? → 단일 작업 클러스터를 확장하는 경우

여러 개의 작은 작업을 실행하려면 Dataproc 클러스터를 설계해야 합니다. 많은 작업(전부는 아님)이 우선순위가 높습니다. 어떻게 해야 할까요? → 일시적인 클러스터를 사용하세요.