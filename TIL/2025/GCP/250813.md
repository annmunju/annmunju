# AI 기반

## Why AI?
- AI 의 강점 설명
- 다국적 기업의 커피 판매 예시 : 
    - 위치 선택과 경로 최적화, 매출 예측 실시간 모니터링, 마케팅 캠페인 자동화 등
    - 멀티모달 데이터 입력 -> 예측과 생성 (고객 세그먼트 분석 등 데이터 분석, 판매 예측, 마케팅 캠페인 자동화 생성) -> 시각적 출력
- 데이터 수집, 데이터 분석, 데이터 엔지니어링, 모델 학습, 모델 테스트, 모델 배포 전 과정 수명주기 개발

## AI/ML on Google Cloud
- AI 기반 레이어 (컴퓨팅과 스토리지 등의 핵심 요소 / 데이터 AI 상품)
- AI 개발 레이어 (Google Cloud 기반 AI 개발 솔루션)
- AI 솔루션 : End-to-End를 제공하는 Vertex AI

## Google Cloud Infrastructure
- 네트워킹 및 보안 레이어 
- 컴퓨팅 및 스토리지 레이어
    - 컴퓨팅 : Compute Engin, GKE, App Engine, Cloud run
        - TPU : gpu, cpu보다 빠른 행렬 곱셈 수행.
    - 스토리지 : Cloud Storage, Cloud Bigtable, Cloud SQL, Cloud Spanner Firestore, BigQuery 
- 데이터 및 AI 상품

## Data and AI Products
- 수집 및 처리 : Pub/Sub와 Dataflow, Dataproc, Cloud Data Fusion
- 적재 : Cloud Storage, BigQuery, Cloud SQL Spanner, Big Table, Fire Store
- 분석 : BigQuery -> Looker(시각화)
- AI/ML 훈련 : Vertex AI, AutoML과 Workbench, 코딩용 Colab Enterprise Vertex AI Studio, 생성형 AI를 위한 Model Garden

## ML model categories
- 지도학습 : 범주형 변수 예측(분류), 수치형 변수 예측(회귀)
- 비지도학습 : 클러스터링(k-means 등), 장바구니 분석, 차원 축소 기법

## BigQuery ML
- 빅쿼리 내에서 모델 관리 및 실행 가능 
- 파라미터 조정, 워크플로 관리 자동화

- 모델 생성
```sql
create model ecommerce.classification
options
    ( 
        model_type='logistic_reg',
        input_label_cols = 'will_buy_later'
    ) as ...
```
- 모델 평가
```sql
select 
    roc_auc,
    accuracy,
    precision,
    recall
from
    ml.evaluate(model `ecommerce.classification`) ...
```

- 모델 사용 (예측)
```sql
select *
from
    ml.predict(model `ecommerce.classification`) ...
```

---

# AI 개발 옵션

## AI development options
- 즉시 사용 가능한 솔루션 로우 코드와 노 코드, DIY 옵션
1. 선행 학습된 API 사용 : 오디오, 이미지 모델 등 다양한 모달리티 모델을 훈련할 수 있음. 학습 데이터가 많이 필요하지는 않음 (fine tunning 개념)
2. BigQuery ML : 테이블 형식만 지원
3. AutoML : Vertex AI에서 자체 머신러닝 모델 빌드. 최소한의 코딩으로 자체 학습 데이터를 사용해 커스텀 모델을 빌드하려는 경우에 선택.
4. Custom Training : 자세한 전문지식 요구. 직접 데이터 준비 등등

## Pre-trained APIs
- 음성, 텍스트, 언어 API = Natural Language API : 선행 학습된 대규모 언어 모델을 사용해 텍스트에서 인사이트를 도출하고 문장에서 항목과 감정을 인식.
- 이미지와 동영상 API
    - Vision API : 정적 이미지에서 콘텐츠를 인식
    - Video Intelligence API : 동영상에서 모션과 동작을 인식
- 문서와 데이터 API = Document API : 텍스트 추출과 양식 파서와 같은 문서 처리 작업을 수행
- 대화형 AI API = Dialogflow API : 대화형 인터페이스 빌드

- 사용 용도
    - 자동 태그 지정
    - 문서 분류
    - 정보 추출
    - 항목 분석
    - 감정 분석

- Gemini 멀티모달 : 여러 모달리티의 데이터를 동일한 Embeddings 선상에 둘 수 있음
- Imagen : 이미지와 자막 생성
- Chirp : 음성 지원 애플리케이션 빌드
- Codey : 코드를 생성하고 완성하며 코드 관련 채팅 지원

## Vertex AI
- 데이터 과학자가 모델 구성을 하기 앞서 필요한 종합 워크플로를 제공하는 통합 플랫폼
1. Vertex AI가 데이터를 준비하고 시간 경과에 따라 대규모로 모델을 생성, 배포, 관리하는 엔드 투 엔드 ML 파이프라인을 제공
    - 데이터 준비 단계 : GCS, BQ 등에 위치 무관하게 데이터 업로드
    - 특성 준비 단계 : Feature Store에서 다른 사용자와 특성 공유
    - 학습과 하이퍼파라미터 조정 
    - 배포 및 모델 모니터링 : 자동으로 모니터링하고 지속적인 개선을 실행해 모델을 프로덕션으로 전환 -> MLOps
2. 예측 AI와 생성형 AI를 모두 수행
    - 판매 예측 및 분류도 가능하고, 멀티모달 콘텐츠도 제작 가능
    - 커스텀한 모델을 직접 빌드할 수 있음

- 이점 요약
    - Seamless(원할함) : 데이터 전과정 원할하게
    - Scalable(확장성) : ML 프로덕션 모니터링 쉽고 스토리지, 컴퓨팅 자동 확장 가능
    - Sustainable(지속가능성) : 모델, feature 재사용 및 공유 가능
    - Speedy(신속성) : 코드 짧게 모델 생성 가능

## AutoML
- Vertex AI에서 제공하는 ML 개발 도구
1. 데이터 처리 : 데이터 세트 업로드하면 데이터 준비 프로세스의 일부를 자동화하는 함수를 제공 
    - 숫자, 날짜, 시간, 텍스트 범주, 배열, 중첩 필드 등을 모델에 피드할 수 있도록 변환
2. 모델 검색 및 파라미터 조정 : AI 기반 모델 검색과 파라티머 조정
3. 전이 학습 : 선행 학습된 모델을 사용해 검색 속도를 높임

- 목표는 최적의 모델을 찾는 것. 적합한 모델을 여럿 (일반적으로 10개) 검색하고 최적의 모델을 취합(평균화)해 예측에 준비시킴. 

## Custom training
- 직접하려면 ML 학습 코드를 어떤 환경에서 사용할지 결정해야함.
    -  ML 모델을 코딩하는 도구로는 Vertex AI Workbench를 사용할 수 있음. 단일 개발 환경에 배포된 Jupyter 노트북.
- 그 다음에는 라이브러리 선택, 사용 : TensorFlow, scikit-learn PyTorch 등 -> JAX 
- 모델 만들고 -> 컴파일 하고 (어떤 방식으로 성능 측정할건지 등 설정) -> 훈련 (.fit)