- 관측성 : 모니터링, 추적 및 로깅
	- 추적 : CloudWatch 지표
	- 로깅 : CloudWatch Logs
	- 가시성 : X-Ray 트레이스
- 로깅
	- 작업 단위에 집중해서 요청 발행인 / 수행하려는 작업 위주 기록
	- 시스템간 동일 트레이스 ID 전파하기 (로그 정렬)
	- 지연 시간 상태 코드 및 크기
	- 프로덕션 환경에서 INFO, DEBUG 수준 로그 끄기
	- 실패 서비스 호출의 요청 ID를 기록
- CloudWatch
	- 에이전트 워크플로에서는 ec2를 중간에 두고 로그를 클라우드 워치 logs에 로그스트림으로 전송
	- 컨테이너 워크플로에서는 DaemonSet 태스크로 정의해서 Logs에는 로그 스트림으로 전송

### CloudWatch 개념
1. 지표 : 시스템 성능과 관련된 데이터
	- 시간 순서로 정렬된 데이터 포인트 집합
	- 하이퍼바이저에 대해 사용할 수 없는 추가 지표를 수집할 수 있음
2. 지표 네임스페이스 : 지표를 위한 컨테이너 (격리됨)
3. 지표 차원
	- 식별자 / 필터
	- 한개의 지표에 30개의 차원을 할당할 수 있음
4. 지표 보존 (최저 1초 해상도. 지표를 보관하는 시간 길이)
5. 지표 필터 : 원하는 기준으로 지표의 데이터 포인트 전환. 
	- 검색하고 필터링하는데 사용
	- 로그 데이터에서 찾고싶은 용어와 이벤트 패턴을 정의
	- 클라우드 워치 logs로 지표 전환하여 그래프를 만들거나 경보를 설정하는데 사용
6. 로그 이벤트 : 모니터링되는 애플리케이션 또는 리소스에서 기록한 활동 레코드 
7. 로그 스트림 : 동일한 소스를 공유하는 로그 이벤트 시퀀스. (애플리케이션 인스턴스에서 오는 이벤트 시퀀스 또는 모니터링 리소스.)
8. 로그 그룹 : 같은 보존 기간, 모니터링 및 액세스 제어 설정을 공유하는 로그 스트림 그룹
9. 보존 설정 : 보존 기간 설정


- 온프렘에서 사용하기
	- AWS Systems Manager 상태 관리자로 CloudWatch 에이전트 설치

### Amazon CloudWatch 로그 인사이트
- 로그 데이터를 대화형 방식으로 검색 및 분석
- 전용 쿼리 사용하여 검색
- 다른 AWS 서비스 로그에서 자동으로 필드를 검색
	- Route 53
	- Lambda
	- CloudTrail
	- VPC
	- 로그 이벤트를 json으로 내보내는 애플리케이션, 사용자 지정 로그

---

- Contributor Insights
	- 시계열 데이터를 분석
	- 개별 기여자 행동 찾고 분석
	- 예) DynamoDB에서 가장 많이 액세스한 파티셔닝 키 식별
- CloudWatch 대시보드
	- 메모리 비율
	- CPU 사용률
	- I/O 시간
	- TCP 연결 수
- 이상 탐지
	- 애플리케이션 지표 분석 및 기준선 결정
	- 지표 추세 변화를 고려해 이상치 판별
	- 지표 예상 값에 대한 경보 생성 혹은 그래프에서 시각적으로 판별할 수 있도록 설정
	- 이상탐지 종류
		- 모델로 훈련하는 케이스
		- 정적 임계값을 지정하는 케이스
- CloudWatch 경보
	- 지표 경보
		- SNS 주제에 알림 전송
		- EC2 작업 수행
		- EC2 Auto Scaling 작업 수행
		- Systems Manager에서 인시던트 생성
		- Systems Manager 자동화 문서 또는 Lambda 함수 시작
	- 복합 경보 : 규칙 표현식을 포함하여 모든 조건 충족시에 알람 상태로 전환
	- 경보 구성
		- 경보 지표 평가의 빈도를 설정 (기간)
		- 데이터 포인트와 같은 기간 수를 통해 판단
- CloudTrail 
	- AWS에서 수행되는 서비스 (API 작업)에 대한 이벤트 기록
	- 인프라 전반에서 계정 활동을 확인, 검색, 다운로드, 보관, 응답할 수 있음
	- CloudWatch Logs를 사용하여 CloudTrail을 구성하면 추적 로그를 모니터링하고 특정 활동이 발생할 때 알림을 받을 수 있음
		- 버킷에 이벤트 전송 > 모니터링 > 분석 수행
	- 활동 감사, 보안사고 식별, 비정상 작업 문제 해결 가능
- EventBridge
	- 시스템 상태가 변경되는 것 == 이벤트 발생
	- 이벤트 기반 지표 모니터링 및 알림
	- 운영 태스크 일정 예약 
	- 이벤트 응답 자동화 등으로 사용
-  VPC 흐름 로그를 사용하여 Amazon VPC의 네트워크 인터페이스로 송수신되는 IP 트래픽에 대한 정보를 캡처
![[Pasted image 20250411111638.png]]
- AWS Compute Optimizer
	- 리소스 사용률, 지표 구성 분석 서비스. 권장사항 생성

---

## 오픈소스 

### 프로메테우스
- 메모리 최적화
- 스토리지 압축
- 소프트웨어 및 장비 구축, 패치, 업그레이드
- 거버넌스 및 보안 구현
- ADOT (아마존 OpenTelemetry)를 사용해 지표 수집
	- ADOT Collector를 사용하여 Prometheus 계측 애플리케이션을 스크랩
![[Pasted image 20250411135044.png]]

### 그라파나
- 지표 시각화 (대시보드 생성)
- 지표 쿼리 및 알림

