## 1.1: 데이터 통합 수행
다양한 데이터 수집 패턴 / 스트리밍 데이터와 배치 데이터 수집을 이해

### 데이터 엔지니어링 수명 주기
- 데이터 생성, 저장, 수집, 변형 및 제공 단계
1. **생성** :  데이터의 특성은 무엇입니까? 소스 시스템에서 데이터가 유지되는 방식은 무엇입니까? 중복 데이터가 존재합니까? 해당 소스 데이터의 스키마는 무엇이고 스키마는 변경됩니까?
2. **저장** : 어떤 스토리지를 사용할 것인지
3. **수집** : 수집되는 데이터의 사용 사례는 무엇입니까? 이 데이터는 수집된 후 어디로 이동합니까? 데이터가 수집되는 빈도 및 볼륨은 어떻게 됩니까? 데이터의 형식은 무엇입니까? 등입니다.
	- 데이터 통합 개념 : 배치 또는 스트리밍과 푸시 또는 풀
	- 재처리 : 실패 혹은 데이터 변경 혹은 업데이트 진행시 재처리 필요
		- 다양한 시뮬레이션 시나리오 및 재처리 시나리오를 사용하여 데이터 수집 파이프라인의 재처리를 테스트하여 멱등성(계속 반복해도 일관된 결과 도출)을 검증하고 데이터 손실, 중복 또는 무결성 문제 없이 일관되게 데이터를 재처리하는 것이 모범 사례
		- 파이프라인이 데이터 중복 또는 불일치 없이 동일한 데이터를 여러 번 처리하는 데 도움이 됩니다. 또한 파이프라인 내에 데이터 처리의 진행 상황 및 상태를 추적하여 마지막으로 성공적으로 처리된 데이터 포인트를 결정하는 체크포인트 메커니즘을 구성합니다. 그러면 오류 또는 중단이 발생할 경우 파이프라인이 해당 포인트부터 처리를 재개
	- 데이터 버전 관리 
		- 원시 또는 중간 데이터를 Amazon S3와 같은 확장 가능한 내구적 스토리지 서비스에 저장 -> 규정 준수 요구 사항, 데이터 거버넌스 정책 및 다시 재생을 위해 일정 기간 동안 데이터를 보존 
		- 데이터 수집 파이프라인 내에 로깅 및 모니터링을 추가하여 진행 상황을 추적, 실패 식별, 파이프라인 동작을 분석하기 위한 관련 로그, 오류 및 지표를 캡처
		- AWS CloudFormation 또는 AWS Cloud Development Kit (AWS CDK) 같은 코드형 인프라 도구를 사용하여 데이터 수집 파이프라인의 배포 및 구성을 자동화 (IaC)
	- 수집 예시
		1. 애플리케이션이 S3 데이터 레이크에 기록 (TSV 파일 형식)
		2. Athena에서 표준 SQL을 사용하여 데이터를 쿼리 및 분석
		3. 혹은 TSV 파일을 Parquet와 같이 열기반 파일 형식으로 변환할 수 있음
		4. 해당 데이터의 하위 집합이 필요하다면 Redshift에 삽입하고 Redshift Spectrum을 사용해 데이터 레이크 내 웨어하우스 쿼리를 결합할 수 있음
		5. 새 데이터가 데이터 레이크에 오면 AWS Glue를 사용해서 테이블 업데이트
- 용도별 서비스
	- S3 : 데이터 레이크
	- Redshift (Spectrum) 데이터 웨어하우스, 레이크 하우스
	- EMR : 빅데이터 처리
	- Kinesis, MSK : 실시간 분석
	- OpenSearch : 모니터링, 로그 분석 등

### 데이터 별 처리 방식 및 서비스
- 데이터의 5V : 다양성 볼륨 속도 정확성 유효성 가치
	- 다양성 : 데이터 유형
	- 볼륨 : 데이터 양(제한 없음). S3 , EBS, Redshift, DynamoDB
	- 속도 : 소스부터 대상까지의 수집 처리 속도. Kinesis, MSK, Opensearch, Lambda
	- 정확성, 유효성 : 데이터 품질 .. 가치 
- 트랜잭션 데이터 : 한 번에 완전히 처리되어야 하는 (트랜잭션) 정보
	- 서비스 : DynamoDB, RDS
	- 이관 : AWS DMS
	- 스테이트풀 및 스테이트리스 : 기억 vs 새롭게 시작
- 스트리밍 데이터 : 실시간 수집. 소용량 이벤트를 대규모로 읽기
	- 서비스 : MSK, Kinesis
	- 이관 : Data Firehose
	- 성능 조정을 충족하려면..? -> 스트림 지표를 모니터링하고 파티션 키 전략등을 사용해 핫 샤드 방지
- 다른 서비스 : AppFlow / Transfer Family / DataSync / Snow Family
- 배치 데이터 수집
	- 즉시 처리할 필요 없는 콜드 데이터
	- EMR (Hadoop / Spark) - JDBC로 RDB에 연결해 데이터 로드 (AWS Glue)

---

## 데이터 엔지니어링 수명 주기

- **단계:** 데이터 생성, 저장, 수집, 변환, 제공
- **생성:** 데이터 발생 위치 (IoT, DB, 메시지 큐 등), 데이터 특성, 빈도, 속도 이해 중요
- **저장:** 소스 데이터 저장 솔루션 선택 (영역 2에서 상세 논의)
- **수집:**
    - 데이터 소스 및 저장 방식 이해 후 데이터 수집
    - 사용 사례, 데이터 이동 경로, 빈도, 볼륨, 형식 고려
    - 배치/스트리밍, 푸시/풀 개념 이해
    - 데이터 수집 파이프라인 재처리 고려 (이벤트 기반 방식 권장: S3, Kinesis, EventBridge 활용)
    - 멱등성 검증, 체크포인트 구성, 데이터 버전 관리, 로깅/모니터링 추가
    - IaC 도구 (CloudFormation, CDK)를 사용한 자동화

## 데이터 수집 단계
1. **생산자**: 데이터 생성 (DB, 모바일 기기, 애플리케이션 등)
2. **수집 도구**: 데이터 수집
3. **소비자**: 데이터 활용 (EC2, AWS DB 서비스, Lambda 등)

## 데이터 수집 예시
- 애플리케이션이 S3에 TSV 형식으로 데이터 저장
    - **데이터 과학**: Athena로 쿼리/분석, Parquet 형식으로 변환
    - **BI 팀**: Redshift로 삽입, Redshift Spectrum으로 데이터 레이크 쿼리 결합
    - **Athena 테이블 업데이트**: AWS Glue, Glue 크롤러 사용
- 다량의 파일이 gzip으로 압축되어 S3에 업로드 후 Redshift에 로드
    - **개선**: gzip 파일을 더 작은 파일로 분할, Redshift COPY 명령 병렬 처리 활용

## 데이터 분석 일반 사용 사례 및 관련 AWS 서비스
- **데이터 레이크**: Amazon S3 (스키마 불필요)
- **데이터 웨어하우스/레이크 하우스**: Amazon Redshift, Redshift Spectrum (SQL 기반 정형/비정형 데이터 분석)
- **빅 데이터 처리**: Amazon EMR (대용량 데이터 빠르고 쉽게 처리)
- **실시간 분석**: Amazon Kinesis (스트리밍 데이터 수집, 처리, 분석), Amazon MSK (스트리밍 데이터 수집, 처리)
- **운영 분석**: Amazon OpenSearch Service (애플리케이션 모니터링, 로그 분석, 클릭스트림 분석)
## 데이터의 5V
- **다양성(Variety)**: 데이터 유형 (정형, 반정형, 비정형 데이터 처리 지원)
- **볼륨(Volume)**: 데이터 양 (AWS 스토리지 서비스: S3, EBS, Redshift, DynamoDB)
- **속도(Velocity)**: 데이터 수집 및 처리 속도 (Kinesis, MSK, OpenSearch Service, Lambda)
- **정확성(Veracity)**: 데이터 품질, 완전성, 정확도
- **가치(Value)**: 비즈니스에 부가가치를 창출하는 데이터

## 데이터 엔지니어링 수명 주기 수집 단계 지원 AWS 서비스

- **트랜잭션 데이터**: DynamoDB, Amazon RDS, AWS DMS
- **스트리밍 데이터**: Amazon MSK, Amazon Kinesis (Data Firehose, Data Streams, Managed Service for Apache Flink, Video Streams), Amazon AppFlow
- **파일 전송 프로토콜**: AWS Transfer Family (FTP, SFTP)
- **온프레미스 스토리지**: AWS DataSync (NFS, SMB)
- **대량 데이터**: AWS Snow Family
- **배치 데이터**: Amazon EMR, AWS Glue

## 스테이트풀 (Stateful) / 스테이트리스 (Stateless) 데이터 트랜잭션
- **스테이트풀**: Amazon ElastiCache for Redis, Amazon RDS (현재 상태 정보 저장)
- **스테이트리스**: Lambda, Amazon API Gateway, Amazon S3 (상태 정보 저장 X)