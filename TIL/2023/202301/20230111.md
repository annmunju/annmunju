# 이상치 감지

---

## Density astimation
- 밀도 판단(평가)
- 목표는 Model p(x)를 만드는 것
    - (가우시안 분포 사용)
    - p(x)가 높으면 likely 할 법한 <-> p(x)가 낮으면 unlikely 
    - 확률 모델 : 모델의 output이 확률

## Gaussian Distribution
- 종모양 분포
- 정규분포 : X~N(평균, 분산)
- (엔트로피 : 높으면 예측가능성이 낮고, 낮으면 예측가능성이 높음)
- 가우시안 분포를 그릴 때 필요한 파라미터
    - 평균 : 다 더하고 개수만큼 나눔
    - 분산 : 각 원소에 평균을 빼고 제곱한 것을 개수만큼 나눔
    - 평균과 분산을 구할 수 있다고 반드시 가우시안 분포로 나오는 것은 아님.
        - (정규분포를 따르지 않는 데이터에는 그에 맞는 모델을 선택해야함)
- likelihood
    - 가능도 = 우도 = 특정 사건들이 일어날 가능성 = 샘플들과 확률분포의 일관된 정도
    - 연속 사건 내에서 특정 확률은 0이다 (예를들면 0~1 값 중 0.001이 나올 확률 = 1/무한대 = 0) → 연속확률 내에서의 지정 가능한 확률

- 최대 우도 추정 (Likelihood) <-> 사후 확률 (Posterior)
    - 예) 나이가 많은 상황 하에 주름을 추정 <-> 주름이 많다는 상황 하에 나이를 추정
    - 분포를 알고 데이터의 확률을 예측하기는 쉬운데 (Likelihood)
    - 데이터가 주어졌을 때 분포를 예측하기에는 어려움 - 정보가 불충분 (Posterior)
        - (베이즈 정리)

= 엡실론보다 낮은 likelihood면 이상치로 판단

## 이상치 감지
- 2차원 예시
    - p(x1, x2) : x1과 x2를 축으로 하는(파라미터로 하는) 확률 
    - p(x1) * p(x2) : 둘은 별개의 독립사건이므로 곱해서 확률을 계산
- 이상치 감지 알고리즘
    1. 독립적인 예시들이 주어짐
    2. 그것에 맞는 각 차원(파라미터)의 평균, 분산을 찾음
    3. 각 파라미터의 확률에 따른 총 확률을 계산. (x1확률 * x2확률)
        - 각 차원은 가우시안 분포를 따름
        - 각 차원은 독립된 사건임
    4. 테스트 예시의 확률 값을 계산해 엡실론(기준점) 이하인 경우 이상치라고 판단.